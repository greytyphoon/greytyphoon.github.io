<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Rémi Doutre">
	<title>Grey's Riddle</title>
	<link rel="stylesheet" href="../../system/pfGeneric.css">
	<style>
		#instructions { max-width: 540px; margin: 0 auto .75rem auto; }
		#solved { text-align: center; text-shadow: 0 0 1px var(--conjuration-green); }
		.hidden:not(.visible) { display: none; }
		.latest { text-shadow: 0 0 3px var(--murder-red); }
		form { text-align: center; position: relative; }
		form > select { position: absolute; }
		#d4 { top: 280px; margin-left: 65px; }
		#d6 { top: 270px; margin-left: -95px; }
		#d8 { top: 155px; margin-left: -105px; }
		#d10 { top: 125px; margin-left: -20px; }
		#d12 { top: 155px; margin-left: 70px; }
		#d20 { top: 210px; margin-left: -20px; }
		#d100 { top: 45px; margin-left: -20px; }
	</style>
</head>
<body>
	<nav id="fixref"><ul>
		<!--<li><a class="back" href="Q8-deck-of-cards.html">Back to Quest</a></li>-->
		<li><a class="home" href="https://greytyphoon.space/PF">Home</a></li>
	</ul></nav>

	<div class="container">
		<header>
			<h1>La porte et les joyaux</h1>
		</header>
		<p>Dans l'alcôve à même la falaise se trouve une porte de pierre finement taillée.
			Aucune poignée n'est visible, mais sept joyaux rouges attirent votre attention.
			Ils sont taillées dans des formes précises et variées, et sur chaque côté un nombre est écrit.</p>
		<p>Ça doit être un code secret pour entrer: en mettant les joyaux sur le bon côté, la porte s'ouvrira.</p>
		<form class="br">
			<svg height="300" width="260">
				<polygon title="d100" points=" 130,20 170,45 160,70 130,80 100,70 90,45" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d10" points=" 130,100 170,125 160,150 130,160 100,150 90,125" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d20" points=" 130,180 170,200 170,240 130,260 90,240 90,200" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d4" points=" 210,250 240,300 180,300" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d6" points=" 30,255 75,255 75,300 30,300" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d8" points=" 40,135 70,165 40,195 10,165" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<polygon title="d12" points=" 220,135 250,160 235,195 205,195 190,160" style="fill:var(--murder-red);stroke:var(--murder-black);stroke-width:1" />
				<line x1="130" y1="80" x2="130" y2="100" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="130" y1="160" x2="130" y2="180" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="90" y1="240" x2="75" y2="255" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="75" y1="280" x2="192" y2="280" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="170" y1="240" x2="198" y2="270" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="220" y1="195" x2="210" y2="250" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="160" y1="150" x2="190" y2="160" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="205" y1="195" x2="170" y2="200" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="100" y1="150" x2="70" y2="165" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="40" y1="195" x2="50" y2="255" style="stroke:var(--murder-black); stroke-width:2" />
				<line x1="55" y1="180" x2="90" y2="200" style="stroke:var(--murder-black); stroke-width:2" />
			</svg>
			<br>
			<select id="d4" >
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
			</select>
			<select id="d6">
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
			</select>
			<select id="d8">
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
			</select>
			<select id="d10">
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
			</select>
			<select id="d100">
				<option value="100">00</option>
				<option>10</option>
				<option>20</option>
				<option>30</option>
				<option>40</option>
				<option>50</option>
				<option>60</option>
				<option>70</option>
				<option>80</option>
				<option>90</option>
			</select>
			<select id="d12">
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
				<option>11</option>
				<option>12</option>
			</select>
			<select id="d20">
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
				<option>9</option>
				<option>10</option>
				<option>11</option>
				<option>12</option>
				<option>13</option>
				<option>14</option>
				<option>15</option>
				<option>16</option>
				<option>17</option>
				<option>18</option>
				<option>19</option>
				<option>20</option>
			</select>
			<br>
			<button type="button" onclick="checkAnswer()">Essayer les dés comme ceci</button>
		</form>
		<div id="instructions" class="apartee hidden">
			Des mots s'affichent alors sur la porte, au-dessus des gemmes...
			<ul class="hints">
				<li class="hidden" id="repeat">Deux dés ne peuvent pas avoir la même valeur.</li>
				<li class="hidden" id="divide">Un dé ne peut pas être un diviseur d'un de ses voisins.</li>
				<li class="hidden" id="even">Un seul dé peut afficher un nombre pair.</li>
			</ul>
		</div>
		<p id="solved" class="hidden">La porte s'ouvre avec un bruit sourd.</p>
	</div>
	<script>
		function checkAnswer() {
			let answerD4 = document.getElementById("d4").value;
			let answerD6 = document.getElementById("d6").value;
			let answerD8 = document.getElementById("d8").value;
			let answerD10 = document.getElementById("d10").value;
			let answerD100 = document.getElementById("d100").value;
			let answerD12 = document.getElementById("d12").value;
			let answerD20 = document.getElementById("d20").value;

			// RULE #1
			if (answerD4 === answerD6 || answerD4 === answerD8 || answerD4 === answerD10 || answerD4 === answerD12 || answerD4 === answerD20
			 || answerD6 === answerD8 || answerD6 === answerD10 || answerD4 === answerD12 || answerD4 === answerD20
			 || answerD8 === answerD10 || answerD8 === answerD12 || answerD8 === answerD20
			 || answerD10 === answerD12 || answerD10 === answerD20
			 || answerD12 === answerD20
			 || answerD100 === answerD10 || answerD100 === answerD12 || answerD100 === answerD20)
			{
				revealHint("repeat");
				return;
			}

			// RULE #2
			if (answerD4 % answerD6 === 0 || answerD6 % answerD4 === 0
			 || answerD4 % answerD12 === 0 || answerD12 % answerD4 === 0
			 || answerD4 % answerD20 === 0 || answerD20 % answerD4 === 0
			 || answerD6 % answerD8 === 0 || answerD8 % answerD6 === 0
			 || answerD6 % answerD20 === 0 || answerD20 % answerD6 === 0
			 || answerD8 % answerD10 === 0 || answerD10 % answerD8 === 0
			 || answerD8 % answerD20 === 0 || answerD20 % answerD8 === 0
			 || answerD10 % answerD12 === 0 || answerD12 % answerD10 === 0
			 || answerD10 % answerD100 === 0 || answerD100 % answerD10 === 0
			 || answerD10 % answerD20 === 0 || answerD20 % answerD10 === 0
			 || answerD12 % answerD20 === 0 || answerD20 % answerD12 === 0)
			{
				revealHint("divide");
				return;
			}

			// RULE #3
			let evenCount = 0;
			if (answerD4 % 2 === 0) evenCount++;
			if (answerD6 % 2 === 0) evenCount++;
			if (answerD8 % 2 === 0) evenCount++;
			if (answerD10 % 2 === 0) evenCount++;
			if (answerD12 % 2 === 0) evenCount++;
			if (answerD20 % 2 === 0) evenCount++;
			if (answerD100 % 2 === 0) evenCount++;
			if (evenCount > 1)
			{
				revealHint("even");
				return;
			}
			
			// SOLVED
			document.getElementById("instructions").classList.remove("visible");
			document.getElementById("solved").classList.add("visible");
		}
		function revealHint(hintId) {
			let oldLatest = document.querySelector(".latest")
			if (oldLatest) oldLatest.classList.remove("latest");

			document.getElementById("instructions").classList.add("visible");
			document.getElementById("solved").classList.remove("visible");

			let hint = document.getElementById(hintId);
			hint.classList.add("visible");
			hint.classList.add("latest");
		}
	</script>
</body>
</html>